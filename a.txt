weikai@weikai-ZenBook-Pro-15-UX550GDX-UX580GD:~$ telnet m1.tme-crypto.fr 1337
Trying 132.227.66.12...
Connected to m1.tme-crypto.fr.
Escape character is '^]'.











[Lower brain functions initialized]

Vous êtes dans un local poubelle.  Il fait tout noir. Il y a des néons au
plafond, mais ils sont éteints.  Seul un éclairage d'urgence de faible
intensité, au niveau du sol, éclaire un peu la pièce.  Le sol et les murs
sont couverts de carrelage, probablement pour faciliter le nettoyage. Une
porte équipée d'une barre anti-panique donne sur une autre pièce.

Ici se trouvent des déchets.
Ici se trouve un conteneur-poubelle.
Ici se trouve une inscription sur le sol.

>>> sortir
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher est
Vous êtes dans un couloir très sombre, orienté nord-sud.  Sur un des murs 
vous distinguez une rangée de néon éteints, mais l'éclairage d'urgence au 
niveau du sol, lui, est opérationnel.  Au plafond, il y a des passages de 
cables, des conduits d'aérations, des canalisations, etc.  Quelques portes 
fermées à clef donnent on ne sait où.  Deux portes palières donnent sur les 
extrémités nord et sud du couloir.  Il y a aussi une porte marquée "trappe 
d'accès" au milieu du couloir (côté ouest).

Ici se trouve un plan interactif.

>>> prendre plan
OK

>>> plan

>>> marcher ouest
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher ouest
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un pied-de-biche.
Ici se trouve un terminal posé sur un bureau.

>>> prendre pied de biche
OK

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.

>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher ouest
Impossible depuis cet endroit

>>> plan

>>> marcher sud
Vous arrivez dans une pièce en forme d'arc de cercle (270°), avec l'éclairage 
d'urgence.  Trois portes donnent sur les couloirs vers l'est, le nord et le sud.

Ici se trouve un ascenseur.

>>> marcher sud 
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Un mur porte l'inscription :
                                _ _     
                               / |    | 
                                      \ 
                               |  _ _  |
                                _|___   
Trois portes conduisent au nord, au sud et à l'est.

Ici se trouve un ascenseur.
Ici se trouve une baie vitrée.

>>> marcher sud
Vous êtes dans un couloir plongé dans l'obscurité, orienté nord-sud.  L'éclairage 
d'urgence ne fonctionne qu'à moitié, donc vous n'y voyez rien du tout.

Ici se trouve un tag sur le mur.

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Une porte fermée à clef porte un symbole ``livre'' ainsi qu'un panneau 
``accès réservé au personnel''.  Une autre porte, qui elle n'est pas fermée 
indique ``réserve''.  Enfin, une porte est marquée ``gallerie nord''.

Ici se trouve un ascenseur.

>>> plan

>>> marcher sud
Impossible depuis cet endroit

>>> marcher ouest
Vous arrivez dans une pièce pleine de livres rangés sur des étagères.  Il fait
vraiment sombre, et vous ne parvenez pas à distinguer les titres des ouvrages,
sauf les quelques-un qui sont juste à côté de l'éclairage "sortie de secours" 
près de la porte.

Ici se trouve un guide OpenSSL (tome I) : chaînes de caractères.
Ici se trouve un guide OpenSSL (tome II) : chiffrement symétrique.
Ici se trouve un guide OpenSSL (tome III) : génération d'une paire de clef.
Ici se trouve un guide OpenSSL (tome IV) : chiffrement à clef publique.
Ici se trouve un guide OpenSSL (tome V) : signature.
Ici se trouve un guide OpenSSL (tome VI) : script d'exemple.

>>> prendre chaînes de caractères
OK

>>> prendre chiffremebt symétrique
OK

>>> prendre génératuib d'une paire de clef
Le mot CLEF est ambigü. Cela pourrait être :
 - guide OpenSSL (tome III) : génération d'une paire de clef
 - guide OpenSSL (tome IV) : chiffrement à clef publique

>>> prendre TOME III
OK

>>> prendre TOMME IV
Le mot IV est ambigü. Cela pourrait être :
 - guide OpenSSL (tome IV) : chiffrement à clef publique
 - carte de l'université
 - plan interactif

>>> prendre chiffrement à clef publique
OK

>>> prendre signature
OK

>>> regarder
Vous arrivez dans une pièce pleine de livres rangés sur des étagères.  Il fait
vraiment sombre, et vous ne parvenez pas à distinguer les titres des ouvrages,
sauf les quelques-un qui sont juste à côté de l'éclairage "sortie de secours" 
près de la porte.

Ici se trouve un guide OpenSSL (tome VI) : script d'exemple.

>>> prendre script d"exemple
Il n'y a pas de D"EXEMPLE

>>> prendre tome VI
OK

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> marcher est 
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Une porte fermée à clef porte un symbole ``livre'' ainsi qu'un panneau 
``accès réservé au personnel''.  Une autre porte, qui elle n'est pas fermée 
indique ``réserve''.  Enfin, une porte est marquée ``gallerie nord''.

Ici se trouve un ascenseur.

>>> marcher est
Impossible depuis cet endroit

>>> marcher nord
Vous êtes dans un couloir plongé dans l'obscurité, orienté nord-sud.  L'éclairage 
d'urgence ne fonctionne qu'à moitié, donc vous n'y voyez rien du tout.

Ici se trouve un tag sur le mur.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Un mur porte l'inscription :
                                _ _     
                               / |    | 
                                      \ 
                               |  _ _  |
                                _|___   
Trois portes conduisent au nord, au sud et à l'est.

Ici se trouve un ascenseur.
Ici se trouve une baie vitrée.

>>> marcher nord
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> marcher nord
Vous arrivez dans une pièce en forme d'arc de cercle (270°), avec l'éclairage 
d'urgence.  Trois portes donnent sur les couloirs vers l'est, le nord et le sud.

Ici se trouve un ascenseur.

>>> marcher nord
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Sur un mur, il y a une inscription à moitié effacée :
                                    _   
                               / |__  / 
                                 |  _   
                                   _ ) |
                               |_  _ _/   
Deux portes donnent au sud et à l'est.

Ici se trouve un ascenseur.

>>> marcher nord
Impossible depuis cet endroit

>>> marcher est
Vous êtes dans un couloir orienté est-ouest.  Les néons ne fonctionnent
toujours pas, mais avec l'éclairage de secours vous distinguez une porte 
entrouverte dans la pénombre.  Elle donne sur un local de service.


>>> marcher est
Vous arrivez dans un petit couloir en forme d'arc de cercle, en béton nu, 
assez sale et poussiereux.  Il y a des traces d'infiltration d'eau sur les murs.  
Personne n'a dû venir ici depuis un bon moment.  L'éclairage normal est en 
rade, mais l'éclairage d'urgence fonctionne.  Il y a pas mal de portes qui 
donnent sur des locaux techniques (plomberie, climatisation, courants faibles, 
etc.) mais elles sont toutes verrouillées.  Trois portes donnent sur des galleries 
à l'ouest, au nord et au sud.

Ici se trouve un ascenseur.
Ici se trouve une tourelle de défense inactive (Mk 3).

>>> marcher est
Impossible depuis cet endroit

>>> marcher nord
Vous êtes dans un couloir assez obscur, orienté nord-sud.

Ici se trouve une inscription sur le mur.

>>> marcher nord
Vous arrivez dans une pièce en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Du texte est peint sur un mur, mais l'inscription est en 
partie effacée :
                              _ __    _   
                                _ \ __  \ 
                               _         |
                                __/ /  _/ 
                             |  _ _| __ _|
Une porte donne sur une gallerie vers le sud.  Une autre porte
est marquée ``DSI DATACENTER 0'' (vers l'est).

Ici se trouve un ascenseur.

>>> marcher nord
Impossible depuis cet endroit

>>> plan

>>> marcher est
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire chaîne de caractère
Une chaine de caractère est une séquence de caractères.  La façon dont
ces caractères sont représentés par des séquences de bits est decrite
par un système d'encodage.  Il en existe de nombreux, et ils sont bien
sûr tous incompatibles entre eux.  Certains ne permettent pas de
représenter tous les caractères.  Par exemple, l'encodage ISO-8859-1
(a.k.a.  latin-1) code les caractères sur un octet.  Il est bien adapté
au monde occidental, mais ne contient pas les signes asiatiques, par
exemple.  Le KOI8-R, lui, permet de représenter les caractères
cyrilliques, etc.

Le système unicode permet de représenter la plupart des caractères connus,
mais il n'est pas très compact (4 octets par caractères).  Représenter des
chaines de caractères comme des séquences de caractères unicode offre
l'avantage de faire disparaître tous ces ennuyeux problèmes d'encodage. C'est
le choix des concepteurs de Python.  Dans ce langage, une chaine de
caractère (un objet de type "str") est représentée en mémoire dans le système
unicode.

Il existe aussi en python un autre type de chaine, les objets de type
"bytes".  Il s'agit d'une simple séquence d'octets, comparable aux
tableaux de type char qu'on a dans le langage C.

>>> type("toto")
<class 'str'>

>>> type(bytes([0, 1, 2]))
<class 'bytes'>

Tout ceci a deux conséquences.


A) Traitement du texte
----------------------

Les programmeurs doivent se soucier de ces problèmes d'encodage
lorsqu'ils doivent transformer des chaines de caractères en séquences
d'octets, par exemple pour les écrire dans un fichier, les envoyer sur
le réseau, ou les transmettre à un autre programme (comme openssl...).
Par défaut dans UGLIX, les chaines unicodes sont encodées en UTF-8
lors de leur conversion en séquences d'octets.

Les chaines unicodes ont une méthode "encode", qui prend en argument
un encodage (la valeur par défaut est "utf-8").

>>> 'toto'.encode()
b'toto'

>>> 'aïlle'.encode()
b'a\xc3\xaflle'

Quand ils sont affichés, les objets de type byte sont préfixés par la
lettre 'b'.  Ils possèdent, eux, une méthode "decode", qui prend
aussi en argument un encodage (utf8 par défaut).

>>> b'\xc3\xa0 V\xc3\xa4\xc3\xafn\xc3\xb6'.decode()
'à Väïnö'

Une situation où l'encodage apparaît explicitement concerne l'utilisation de
OpenSSL.  Il est nécessaire d'encoder les chaines de caractères unicode avant
de les envoyer à openssl (lors du chiffrement), et il est nécessaire de les
décoder en sortie de openssl (lors du déchiffrement) pour récupérer de
l'unicode.


B) Traitement des données binairesregister:136:1|99b75790fbdbdd3d6aac5199f666744ad95939df184fe9d9bae148672833729dnt pour afficher des caractères ASCII.
Pour contourner cette difficulté, il faut encoder les bytes() en
quelque chose qui soit du texte acceptable, pour en faire une str().
Dans UGLIX, on utilise généralement à cette fin deux encodages : en base64
(les séquences d'octets sont découpées en paquets de 6 bits, et chaque
paquet est converti en une lettre) ou bien en hexadécimal.

Pour ceci, on fait appel aux fonctions b64encode et b64decode du
module base64.  Voici un exemple

>>> import base64
>>> base64.b64encode(s)
b'AAUULVB9tPVAlQ=='

Notez qu'on récupère des "bytes".  Mais ceux-là, on peut les convertir
en texte sans douleur.

>>> b'AAUULVB9tPVAlQ=='.decode()
'AAUULVB9tPVAlQ=='

Les objets de type "bytes" ont une méthode .hex() qui fait
ce que son nom indique :

>>> s.hex()
'0005142d507db4f54095'

De plus, on peut convertir la représentation hexadécimale en bytes()
avec la "méthode de classe" bytes.fromhex() :

>>> bytes.fromhex('deadbeef')
b'\xde\xad\xbe\xef'

>>> lire chaîne de caractères
Une chaine de caractère est une séquence de caractères.  La façon dont
ces caractères sont représentés par des séquences de bits est decrite
par un système d'encodage.  Il en existe de nombreux, et ils sont bien
sûr tous incompatibles entre eux.  Certains ne permettent pas de
représenter tous les caractères.  Par exemple, l'encodage ISO-8859-1
(a.k.a.  latin-1) code les caractères sur un octet.  Il est bien adapté
au monde occidental, mais ne contient pas les signes asiatiques, par
exemple.  Le KOI8-R, lui, permet de représenter les caractères
cyrilliques, etc.

Le système unicode permet de représenter la plupart des caractères connus,
mais il n'est pas très compact (4 octets par caractères).  Représenter des
chaines de caractères comme des séquences de caractères unicode offre
l'avantage de faire disparaître tous ces ennuyeux problèmes d'encodage. C'est
le choix des concepteurs de Python.  Dans ce langage, une chaine de
caractère (un objet de type "str") est représentée en mémoire dans le système
unicode.

Il existe aussi en python un autre type de chaine, les objets de type
"bytes".  Il s'agit d'une simple séquence d'octets, comparable aux
tableaux de type char qu'on a dans le langage C.

>>> type("toto")
<class 'str'>

>>> type(bytes([0, 1, 2]))
<class 'bytes'>

Tout ceci a deux conséquences.


A) Traitement du texte
----------------------

Les programmeurs doivent se soucier de ces problèmes d'encodage
lorsqu'ils doivent transformer des chaines de caractères en séquences
d'octets, par exemple pour les écrire dans un fichier, les envoyer sur
le réseau, ou les transmettre à un autre programme (comme openssl...).
Par défaut dans UGLIX, les chaines unicodes sont encodées en UTF-8
lors de leur conversion en séquences d'octets.

Les chaines unicodes ont une méthode "encode", qui prend en argument
un encodage (la valeur par défaut est "utf-8").

>>> 'toto'.encode()
b'toto'

>>> 'aïlle'.encode()
b'a\xc3\xaflle'

Quand ils sont affichés, les objets de type byte sont préfixés par la
lettre 'b'.  Ils possèdent, eux, une méthode "decode", qui prend
aussi en argument un encodage (utf8 par défaut).

>>> b'\xc3\xa0 V\xc3\xa4\xc3\xafn\xc3\xb6'.decode()
'à Väïnö'

Une situation où l'encodage apparaît explicitement concerne l'utilisation de
OpenSSL.  Il est nécessaire d'encoder les chaines de caractères unicode avant
de les envoyer à openssl (lors du chiffrement), et il est nécessaire de les
décoder en sortie de openssl (lors du déchiffrement) pour récupérer de
l'unicode.


B) Traitement des données binaires
----------------------------------

Il est parfois nécessaire d'envoyer ou de recevoir des requêtes
contenant des données binaires, qui ne sont pas interprétables comme
des chaines de caractères (il y a en effet des séquences d'octets qui
sont des encodages invalides en UTF-8, et qui sont donc rejetées lors
du décodage).  Par exemple :

>>> s = bytes([5*i*i & 0xff for i in range(10)])
>>> s.decode()
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb4 in position 6: invalid start byte

Dans ce cas-là, il faudrait transmettre des objets de type bytes().  Le
petit problème, c'est que les bytes() ne sont pas forcément affichables 
sur un terminal conçu principalement pour afficher des caractères ASCII.
Pour contourner cette difficulté, il faut encoder les bytes() en
quelque chose qui soit du texte acceptable, pour en faire une str().
Dans UGLIX, on utilise généralement à cette fin deux encodages : en base64
(les séquences d'octets sont découpées en paquets de 6 bits, et chaque
paquet est converti en une lettre) ou bien en hexadécimal.

Pour ceci, on fait appel aux fonctions b64encode et b64decode du
module base64.  Voici un exemple

>>> import base64
>>> base64.b64encode(s)
b'AAUULVB9tPVAlQ=='

Notez qu'on récupère des "bytes".  Mais ceux-là, on peut les convertir
en texte sans douleur.

>>> b'AAUULVB9tPVAlQ=='.decode()
'AAUULVB9tPVAlQ=='

Les objets de type "bytes" ont une méthode .hex() qui fait
ce que son nom indique :

>>> s.hex()
'0005142d507db4f54095'

De plus, on peut convertir la représentation hexadécimale en bytes()
avec la "méthode de classe" bytes.fromhex() :

>>> bytes.fromhex('deadbeef')
b'\xde\xad\xbe\xef'

[703b2b3bd967f932ab0bd88b5f1d3a4e] asnwer
>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire script d'exemple
import subprocess

# ce script suppose qu'il a affaire à OpenSSL v1.1.1
# vérifier avec "openssl version" en cas de doute.
# attention à MacOS, qui fournit à la place LibreSSL.

# en cas de problème, cette exception est déclenchée
class OpensslError(Exception):
    pass

# Il vaut mieux être conscient de la différence entre str() et bytes()

def encrypt(plaintext, passphrase, cipher='aes-128-cbc'):
    """invoke the OpenSSL library (though the openssl executable which must be
       present on your system) to encrypt content using a symmetric cipher.

       The passphrase is an str object (a unicode string)
       The plaintext is str() or bytes()
       The output is bytes()

       # encryption use
       >>> message = "texte avec caractères accentués"
       >>> c = encrypt(message, 'foobar')       
    """
    # prépare les arguments à envoyer à openssl
    pass_arg = 'pass:{}'.format(passphrase)
    args = ['openssl', 'enc', '-' + cipher, '-base64', '-pass', pass_arg, '-pbkdf2']
    
    # si plaintext est de stype str, on est obligé de l'encoder en bytes pour
    # pouvoir l'envoyer dans le pipeline vers openssl
    if isinstance(plaintext, str):
        plaintext = plaintext.encode('utf-8')
    
    # ouvre le pipeline vers openssl. envoie plaintext sur le stdin de openssl, récupère stdout et stderr
    #    affiche la commande invoquée
    #    print('debug : {0}'.format(' '.join(args)))
    result = subprocess.run(args, input=plaintext, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

    # si un message d'erreur est présent sur stderr, on arrête tout
    # attention, sur stderr on récupère des bytes(), donc on convertit
    error_message = result.stderr.decode()
    if error_message != '':
        raise OpensslError(error_message)

    # OK, openssl a envoyé le chiffré sur stdout, en base64.
    # On récupère des bytes, donc on en fait une chaine unicode
    return result.stdout.decode()

# TODO :
# - implement the decrypt() method
# - write a KeyPair class
# - write a PublicKey class
# - etc.

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire génération d'une paire de clef
Le mot CLEF est ambigü. Cela pourrait être :
 - guide OpenSSL (tome III) : génération d'une paire de clef
 - guide OpenSSL (tome IV) : chiffrement à clef publique

>>> lire génération d'une paire de clef
Le mot CLEF est ambigü. Cela pourrait être :
 - guide OpenSSL (tome III) : génération d'une paire de clef
 - guide OpenSSL (tome IV) : chiffrement à clef publique

>>> lire TOME III
GÉNÉRATION D'UNE PAIRE DE CLEFS
===============================

Openssl permet de générer des paires de clefs, avec la commande : 

    openssl genpkey <options>

Encore une fois, vous êtes encouragés à consulter "man genpkey" et 
la documentation de openssl.  Par défaut, le résultat est envoyé sur
la sortie standard.  Le résultat contient la paire de clefs, au format
PEM (c'est de l'ASCII) propre à openssl et un peu pénible à décoder à
la main. 

Par exemple, pour générer une paire de clefs RSA de 1024 bits :

    openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:1024


Une commande permet d'extraire la clef publique uniquement, pour la
communiquer à des tiers : 

    openssl pkey -in <fichier contenant la clef secrète> -pubout



>>> lire chiffrement à clef publique
CHIFFREMENT À CLEF PUBLIQUE
===========================

Openssl permet d'effectuer du chiffrement/déchiffrement asymétrique, avec
l'algorithme RSA.  Vous êtes invité à consulter la page de manuel
correspondante (man openssl-pkeyutl). 

L'usage d'openssl pour effectuer des opérations de (dé)chiffrement asymétrique
a deux limitations :

1) Le message clair DOIT être plus court que la clef.  Si ce n'est pas le cas,
   l'opération échoue avec un message "Public Key operation error, data too 
   large for key size".  Avec une clef de 2000 bits, vous avez droit à environ
   1800 bits de message.  C'est une limitation de l'algorithme lui-même.

2) Openssl ne prévoit pas d'encoder le résultat de l'opération de chiffrement
   en base64.  Par contre il y a une option pour l'encodage en... hexadécimal.

La commande essentielle pour le chiffrement :

   openssl pkeyutl -encrypt -hexdump -pubin -inkey <fichier contenant la clef publique>

Ceci attend un message sur l'entrée standard, et affichera son chiffrement sur
la sortie standard.  Pour déchiffrer, il faut fournir la clef secrète (et donc
retirer l'option  "-pubin")

>>> conseil
Vous pouvez obtenir des indications avec cette commande.

Sans argument, cette commande vous suggérera une tâche à accomplir.

Avec le nom d'un objet en argument, la commande vous donnera des conseils de plus en
plus précis pour vous aider à acquérir ou à utiliser l'objet en question.

Si vous avez bien compris, vous pouvez ré-essayer.

>>> regader
Il n'y a pas de REGADER

>>> plan

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> clear
Il n'y a pas de CLEAR

>>> conseil 
Essayez de vous connecter au terminal.  N'oubliez pas de regarder
le mode d'emploi, de lire l'inscription au mur et de jeter un coup
d'oeil sous le clavier...  Sachez enfin qu'il y a de la documentation
dans une autre pièce qui se trouve globalement au sud-ouest.


>>> plan

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> regarder rack
il porte la mention ``SECURITY ENGINE''.  Il a effectivement l'air... sécurisé.

>>> prendre rack
Il doit peser une tonne !

>>> regarder inscription 
On dirait qu'elle a été tracé avec le doigt, avec un liquide marron foncé, 
légèrement visqueux mais qui est complètement sec maintenant.  Elle dit :
    
      POST-IT PASSWORD: ISECR0XX

>>> regard
Il n'y a pas de REGARD

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> lire mode d'emploi
C'est le guide d'utilisation du terminal d'administration système qui est 
juste à côté.  Il fait 700 pages, donc vous sautez directement au chapitre 
``Mise en route''.  En gros, il suffit d'appuyer sur le bouton et de se 
laisser guide par l'interface utilisateur ultra-intuitive.  Les administrateurs
sont néanmoins mis en garde face aux risques encourus et ils doivent avoir été
soigneusement formés à l'utilisation des mécanismes de sécurité.  Pour éviter
les risques, un mot de passe est demandé au boot.  Les bonnes pratiques de
gestion des mots de passe sont rappelées : ne pas les mettre sur un post-it
sous le clavier, etc.  En désespoir de cause, il est recommandé de chiffrer
les mots de passe sur les post-it sous les clavier.  Ce serait mieux que rien.

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> prendre clavier
Il faudrait couper le fil.

>>> couper le fil
Il n'y a pas de FIL

>>> utiliser clavier
C'est peut-être le terminal qui lui est relié que vous voulez utiliser ?

>>> utiliser terminal

>>> regarder rack
il porte la mention ``SECURITY ENGINE''.  Il a effectivement l'air... sécurisé.

>>> utiliser rack
Mis à part donner un coup de pied dedans, il n'y a rien à faire.  Vu le blindage, 
le risque de fracture n'est pas complètement négligeable.  Vous laissez tomber.


>>> utiliser mode d'emploi
Il faut le LIRE, le REGARDER ou l'EXAMINER.

>>> lire mode d'emploi
C'est le guide d'utilisation du terminal d'administration système qui est 
juste à côté.  Il fait 700 pages, donc vous sautez directement au chapitre 
``Mise en route''.  En gros, il suffit d'appuyer sur le bouton et de se 
laisser guide par l'interface utilisateur ultra-intuitive.  Les administrateurs
sont néanmoins mis en garde face aux risques encourus et ils doivent avoir été
soigneusement formés à l'utilisation des mécanismes de sécurité.  Pour éviter
les risques, un mot de passe est demandé au boot.  Les bonnes pratiques de
gestion des mots de passe sont rappelées : ne pas les mettre sur un post-it
sous le clavier, etc.  En désespoir de cause, il est recommandé de chiffrer
les mots de passe sur les post-it sous les clavier.  Ce serait mieux que rien.

>>> regarder clavier
Un bon vieux modèle 104 touches, AZERTY.  Conçu pour durer il y a 45 ans.
Sans surprise, il y a un post-it en dessous.  Il indique:
U2FsdGVkX1/51wqD7PnMSuRkwL8czQ1S/AznUxY9Z+K2tN2o5LBv1C2cM2fDGGD9
hQym6B/W3VH0TNEn7dU2Xg==

>>> openssl pkeyult -decrypt -hexdump -inkey U2FsdGVkX1/51wqD7PnMSuRkwL8czQ1S/AznUxY9Z+K2tN2o5LBv1C2cM2fDGGD9
Il n'y a pas de U2FSDGVKX1/51WQD7PNMSURKWL8CZQ1S/AZNUXY9Z+K2TN2O5LBV1C2CM2FDGGD9

>>> hQym6B/W3VH0TNEn7dU2Xg==
Il n'y a pas de HQYM6B/W3VH0TNEN7DU2XG==

>>> openssl pkeyult -decrypt -hexdump -inkey U2FsdGVkX1/51wqD7PnMSuRkwL8czQ1S/AznUxY9Z+K2tN2o5LBv1C2cM2fDGGD9
Il n'y a pas de U2FSDGVKX1/51WQD7PNMSURKWL8CZQ1S/AZNUXY9Z+K2TN2O5LBV1C2CM2FDGGD9

>>> hQym6B/W3VH0TNEn7dU2Xg==
Il n'y a pas de HQYM6B/W3VH0TNEN7DU2XG==

>>> openssl pkeyult -decrypt -hexdump -inkey ICECROXX -in U2FsdGVkX1/51wqD7PnMSuRkwL8czQ1S/AznUxY9Z+K2tN2o5LBv1C2cM2fDGGD9
Il n'y a pas de U2FSDGVKX1/51WQD7PNMSURKWL8CZQ1S/AZNUXY9Z+K2TN2O5LBV1C2CM2FDGGD9

>>> hQym6B/W3VH0TNEn7dU2Xg==
Il n'y a pas de HQYM6B/W3VH0TNEN7DU2XG==

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> U2FsdGVkX1/51wqD7PnMSuRkwL8czQ1S/AznUxY9Z+K2tN2o5LBv1C2cM2fDGGD9
Il n'y a pas de U2FSDGVKX1/51WQD7PNMSURKWL8CZQ1S/AZNUXY9Z+K2TN2O5LBV1C2CM2FDGGD9

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire chiffrement symétrique
CHIFFREMENT SYMÉTRIQUE
======================

L'essentiel des tâches de chiffrement peut être réalisé avec la
bibliothèque OpenSSL (la version 1.0 est requise au minimum).

La plupart du temps, les utilisateurs d'UGLIX chiffrent leurs fichiers
avec un mécanisme à clef secrète et en utilisant un mot de passe.
OpenSSL se débrouille pour convertir ce mot de passe en une clef
secrète et un vecteur d'initialisation. De l'aléa est généralement
introduit dans ce processus.

Pour augmenter la portabilité, les utilisateurs d'UGLIX stockent
généralement les fichiers chiffrés en les encodant en base64.

Enfin, par défaut, les utilisateurs d'UGLIX sont invités à utiliser
l'AES-128 en mode CBC pour chiffrer leurs données.

Vous êtes invités à vous reporter à la documentation plus détaillée de
OpenSSL, en particulier en exécutant "man openssl", "openssl enc
help", ou bien en consultant la page du mode d'emploi de openssl
dédiée au chiffrement symétrique ("man openssl-enc").

Déchiffrer le fichier "foo" en utilisant le mot de passe "bar" peut
logiquement s'accomplir par la commande :

openssl enc -d -base64 -aes-128-cbc -pbkdf2 -pass pass:"bar" -in foo

Il est très pratique de pouvoir invoquer openssl depuis des programmes.
Pour cette raison, un autre script open-source est mis à la disposition
de la communauté. On le trouve dans le guide intitulé "script d'exemple".

Vous êtes invité à l'adapter à tous vos besoins.

    ⚠      Il existe plusieurs versions de OpenSSL. Ce serveur UGLIX utilise
   ⚠ ⚠     "OpenSSL 1.1.1d  10 Sep 2019". N'hésitez pas à vérifier avec la 
  ⚠ | ⚠    commande "openssl version". Il FAUT une version supérieure à 1.1.1 !
 ⚠  o  ⚠   Si vous avez la 1.1.0 (ou plus ancienne), l'option -pbkdf2 ne sera
⚠⚠⚠⚠⚠⚠⚠⚠⚠  pas reconnue.
    |      
    |      Attention, sur les versions récentes de MacOS, "openssl" est en fait
    |      LibreSSL (un fork). Et il est partiellement incompatible !

>>> regarder clavier
Un bon vieux modèle 104 touches, AZERTY.  Conçu pour durer il y a 45 ans.
Sans surprise, il y a un post-it en dessous.  Il indique:
U2FsdGVkX1+mrZRCihhXKhzA1c0qlUOdoGhqghaQsZmjcH2sfv62xMXqTvqqqF+2
gF6eOm8R3vAD8gA8VXXt7A==

>>> utiliser terminal

>>> utiliser terminal
[security engine] register:136:1|99b75790fbdbdd3d6aac5199f666744ad95939df184fe9d9bae148672833729d
>>> 
[security engine - ERROR] corrupted configuration file
[security engine - INFO] enforcing DEFAULT security policy
[security engine - ERROR] corrupted event log
>>> conseil
Essayez de vous connecter au terminal.  N'oubliez pas de regarder
le mode d'emploi, de lire l'inscription au mur et de jeter un coup
d'oeil sous le clavier...  Sachez enfin qu'il y a de la documentation
dans une autre pièce qui se trouve globalement au sud-ouest.


[security engine - INFO] starting event log recovery
>>> plan

>>> plan

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> utiliser terminal
Il ne redémarre plus.

>>> conseil
Essayez de vous connecter au terminal.  N'oubliez pas de regarder
le mode d'emploi, de lire l'inscription au mur et de jeter un coup
d'oeil sous le clavier...  Sachez enfin qu'il y a de la documentation
dans une autre pièce qui se trouve globalement au sud-ouest.


>>> regarder mode d'emploi
C'est le guide d'utilisation du terminal d'administration système qui est 
juste à côté.  Il fait 700 pages, donc vous sautez directement au chapitre 
``Mise en route''.  En gros, il suffit d'appuyer sur le bouton et de se 
laisser guide par l'interface utilisateur ultra-intuitive.  Les administrateurs
sont néanmoins mis en garde face aux risques encourus et ils doivent avoir été
soigneusement formés à l'utilisation des mécanismes de sécurité.  Pour éviter
les risques, un mot de passe est demandé au boot.  Les bonnes pratiques de
gestion des mots de passe sont rappelées : ne pas les mettre sur un post-it
sous le clavier, etc.  En désespoir de cause, il est recommandé de chiffrer
les mots de passe sur les post-it sous les clavier.  Ce serait mieux que rien.

>>> inspecter l'instruction
Il n'y a pas de L'INSTRUCTION

>>> regarder instruction
Il n'y a pas de INSTRUCTION

>>> lire inscription
On dirait qu'elle a été tracé avec le doigt, avec un liquide marron foncé, 
légèrement visqueux mais qui est complètement sec maintenant.  Elle dit :
    
                           [--------REDACTED--------]

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> conseil 
Essayez de vous connecter au terminal.  N'oubliez pas de regarder
le mode d'emploi, de lire l'inscription au mur et de jeter un coup
d'oeil sous le clavier...  Sachez enfin qu'il y a de la documentation
dans une autre pièce qui se trouve globalement au sud-ouest.


>>> utiliser terminal
Il ne redémarre plus.

>>> ls
Vous arrivez dans ce qui est manifestement une salle serveur.  Tout est éteint
et silencieux.  Il y a de l'éclairage de secours et vous distinguez des dizaines
de racks.  Ils ont un système de fermeture donc vous ne pouvez pas accéder aux 
serveurs qu'ils contiennent.  L'un d'entre eux attire particulièrement votre 
attention.  Il y a aussi un bureau dans un coin.

Ici se trouve un rack plus blindé que les autres.
Ici se trouve une inscription sur le mur.
Ici se trouve un terminal d'administration système.
Ici se trouve un clavier.
Ici se trouve un mode d'emploi.

>>> plan

>>> marcher ouest
Vous arrivez dans une pièce en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Du texte est peint sur un mur, mais l'inscription est en 
partie effacée :
                              _ __    _   
                                _ \ __  \ 
                               _         |
                                __/ /  _/ 
                             |  _ _| __ _|
Une porte donne sur une gallerie vers le sud.  Une autre porte
est marquée ``DSI DATACENTER 0'' (vers l'est).

Ici se trouve un ascenseur.

>>> marcher ouest
Impossible depuis cet endroit

>>> marcher sud
Vous êtes dans un couloir assez obscur, orienté nord-sud.

Ici se trouve une inscription sur le mur.

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, en béton nu, 
assez sale et poussiereux.  Il y a des traces d'infiltration d'eau sur les murs.  
Personne n'a dû venir ici depuis un bon moment.  L'éclairage normal est en 
rade, mais l'éclairage d'urgence fonctionne.  Il y a pas mal de portes qui 
donnent sur des locaux techniques (plomberie, climatisation, courants faibles, 
etc.) mais elles sont toutes verrouillées.  Trois portes donnent sur des galleries 
à l'ouest, au nord et au sud.

Ici se trouve un ascenseur.
Ici se trouve une tourelle de défense inactive (Mk 3).

>>> marcher sud
Vous êtes dans un couloir très sombre, orienté nord-sud.  Sur un des murs 
vous distinguez une rangée de néon éteints, mais l'éclairage d'urgence au 
niveau du sol, lui, est opérationnel.  Au plafond, il y a des passages de 
cables, des conduits d'aérations, des canalisations, etc.  Quelques portes 
fermées à clef donnent on ne sait où.  Deux portes palières donnent sur les 
extrémités nord et sud du couloir.  Il y a aussi une porte marquée "trappe 
d'accès" au milieu du couloir (côté ouest).


>>> plan

>>> marcher ouest
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher ouest
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> ls
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> inspecter dispositif
Une sorte de machine pour des expériences de physique.  Il y a des fils, des
tubes, etc. qui convergent dans une sorte de globe métallique. C'est assez 
imposant.  Impossible de deviner à quoi ça peut bien servir.

>>> destroy dispositif
Vous donnez un grand coup de pied dans la machine.  À votre grand soulagement, 
ça n'ouvre pas un portail interdimensionnel vers un autre monde rempli de 
monstres.  En fait, il ne se passe rien.


>>> utiliser terminal

Vous entendez un bruit électrique derrière vous.

La machine bizarre qui se trouve au milieu de la pièce est maintenant sous tension !

                                                                                       Process complete --- shutdown                                                                                        

Vous entendez la machine s'éteindre.

Vous vous demandez à quoi elle sert vraiment.  En attendant, quelque chose a l'air
légèrement différent, mais ne parvenez pas à mettre le doigt dessus.

[security engine - ERROR] corrupted configuration file
[security engine - INFO] enforcing DEFAULT security policy
>>> conseil
Vous ne trouvez pas qu'il fait sombre ?  Essayez de remettre le courant.
Vous devrez aller au sud-est.

>>> plan

>>> inspecter
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> utiliser terminal

Vous entendez un bruit électrique derrière vous.

La machine bizarre qui se trouve au milieu de la pièce est maintenant sous tension !

                                                                                       Process complete --- shutdown                                                                                        

Vous entendez la machine s'éteindre.

Vous vous demandez à quoi elle sert vraiment.  En attendant, quelque chose a l'air
légèrement différent, mais ne parvenez pas à mettre le doigt dessus.
[security engine - ERROR] corrupted event log
[security engine - INFO] starting event log recovery
>>> 
>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

[security engine - ERROR] corrupted configuration file
>>> plan
[security engine - INFO] enforcing DEFAULT security policy
>>> 
>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher ouest
Impossible depuis cet endroit

>>> marcher sud
Vous arrivez dans une pièce en forme d'arc de cercle (270°), avec l'éclairage 
d'urgence.  Trois portes donnent sur les couloirs vers l'est, le nord et le sud.

Ici se trouve un ascenseur.

>>> marcher sud
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> ls
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> plan
[security engine - ERROR] corrupted event log
>>> 
[security engine - INFO] starting event log recovery
>>> conseil
Vous ne trouvez pas qu'il fait sombre ?  Essayez de remettre le courant.
Vous devrez aller au sud-est.

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Un mur porte l'inscription :
                                _ _     
                               / |    | 
                                      \ 
                               |  _ _  |
                                _|___   
Trois portes conduisent au nord, au sud et à l'est.

Ici se trouve un ascenseur.
Ici se trouve une baie vitrée.

>>> plan

>>> marcher est
Vous êtes dans un couloir orienté est-ouest.  Sur le côté, une porte est 
entrouverte.  Elle donne sur un local de service.

Ici se trouve un extincteur.

>>> marcher est
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Il y a deux portes qui conduisent au sud et à l'ouest.

Ici se trouve un ascenseur.

>>> marcher est
Impossible depuis cet endroit

>>> marcher est
Impossible depuis cet endroit

>>> plan

>>> marcher sud
Vous êtes dans un couloir orienté nord-sud.

Ici se trouve un tag sur le mur.

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Il y a une inscription à moitié effacée sur le mur :
                              _  _    _   
                              ___     /_  
                               __    '_ \ 
                              / _ /   _   
                             | _  _  ___  
Une porte indique ``local courants forts''.

Ici se trouve un ascenseur.

>>> plan

>>> marcher est
Vous arrivez dans une pièce plongée dans l'obscurité, avec un peu d'éclairage
de secours.  Vous devinez la présence d'un transformateur électrique de la taille
d'une voiture, sur lequel arrivent de gros cables.  Il y a aussi des armoires 
électriques.  Des autocollants fluorescents ``éclair'' et ``tête de mort''
sont visibles malgré l'obscurité.

Ici se trouve un terminal de contrôle.

>>> utiliser terminal
Le terminal s'est éteint en vous traitant de débutant.

>>> conseil
Vous devez utiliser un terminal de service.  Il y en a un pas très loin.

>>> plan

>>> ls
Vous arrivez dans une pièce plongée dans l'obscurité, avec un peu d'éclairage
de secours.  Vous devinez la présence d'un transformateur électrique de la taille
d'une voiture, sur lequel arrivent de gros cables.  Il y a aussi des armoires 
électriques.  Des autocollants fluorescents ``éclair'' et ``tête de mort''
sont visibles malgré l'obscurité.

Ici se trouve un terminal de contrôle.

>>> utiliser terminal
La pièce est toujours sombre et silencieuse.

>>> conseil
Vous devez utiliser un terminal de service.  Il y en a un pas très loin.

>>> plan

>>> marcher ouest
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Il y a une inscription à moitié effacée sur le mur :
                              _  _    _   
                              ___     /_  
                               __    '_ \ 
                              / _ /   _   
                             | _  _  ___  
Une porte indique ``local courants forts''.

Ici se trouve un ascenseur.

>>> marcher nord
Vous êtes dans un couloir orienté nord-sud.

Ici se trouve un tag sur le mur.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Il y a deux portes qui conduisent au sud et à l'ouest.

Ici se trouve un ascenseur.

>>> marcher nord
Impossible depuis cet endroit

>>> marcher ouest
Vous êtes dans un couloir orienté est-ouest.  Sur le côté, une porte est 
entrouverte.  Elle donne sur un local de service.

Ici se trouve un extincteur.

>>> prendre extincteur
OK

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un pied-de-biche.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.
 - un extincteur.

>>> 
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> plan

>>> ls
Vous êtes dans un couloir orienté est-ouest.  Sur le côté, une porte est 
entrouverte.  Elle donne sur un local de service.


>>> ouvrir porte
Impossible depuis cet endroit

>>> entrer 
Impossible depuis cet endroit

>>> marcher sud
Vous arrivez dans un local exigu, tout noir.  C'est sûrement un vestiaire, en
tout cas il y a des casiers pour le personnel.

Ici se trouve un terminal de service.

>>> utiliser terminal

>>> utiliser terminal

>>> utiliser terminal



[Lower brain functions initialized]

Vous êtes dans un local poubelle.  Il fait tout noir. Il y a des néons au
plafond, mais ils sont éteints.  Seul un éclairage d'urgence de faible
intensité, au niveau du sol, éclaire un peu la pièce.  Le sol et les murs
sont couverts de carrelage, probablement pour faciliter le nettoyage. Une
porte équipée d'une barre anti-panique donne sur une autre pièce.

Ici se trouvent des déchets.
Ici se trouve un conteneur-poubelle.
Ici se trouve une inscription sur le sol.

>>> sortir
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher ouest
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un pied-de-biche.
Ici se trouve un terminal posé sur un bureau.

>>> utiliser terminal

Vous entendez un bruit électrique derrière vous.

La machine bizarre qui se trouve au milieu de la pièce est maintenant sous tension !

                                                                                       Process complete --- shutdown                                                                                        

Vous entendez la machine s'éteindre.

Vous vous demandez à quoi elle sert vraiment.  En attendant, quelque chose a l'air
légèrement différent, mais ne parvenez pas à mettre le doigt dessus.

>>>ls
Il n'y a pas de RLS

[security engine - ERROR] corrupted configuration file
[security engine - INFO] enforcing DEFAULT security policy
>>> plan

>>> plan

>>>                              _  _    _   
Le mot _ est ambigü. Cela pourrait être :
 - terminal posé sur un bureau
 - carte de l'université
 - plan interactif

>>>                               ___     /_  
Il n'y a pas de /_

>>>                                __    '_ \ 
Il n'y a pas de \

>>>                               / _ /   _   
Le mot _ est ambigü. Cela pourrait être :
 - terminal posé sur un bureau
 - carte de l'université
 - plan interactif

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un extincteur.
 - un plan interactif.

[security engine - ERROR] corrupted event log
>>> inventaire
Vous avez :
 - une carte de l'université.
 - un extincteur.
 - un plan interactif.

[security engine - INFO] starting event log recovery
>>> ls
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> plan

>>> marcher sud
Vous arrivez dans une pièce en forme d'arc de cercle (270°), avec l'éclairage 
d'urgence.  Trois portes donnent sur les couloirs vers l'est, le nord et le sud.

Ici se trouve un ascenseur.

>>> marcher sud
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> marcher
Dans quelle direction ?

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Un mur porte l'inscription :
                                _ _     
                               / |    | 
                                      \ 
                               |  _ _  |
                                _|___   
Trois portes conduisent au nord, au sud et à l'est.

Ici se trouve un ascenseur.
Ici se trouve une baie vitrée.

>>> marcher sud
Vous êtes dans un couloir plongé dans l'obscurité, orienté nord-sud.  L'éclairage 
d'urgence ne fonctionne qu'à moitié, donc vous n'y voyez rien du tout.

Ici se trouve un tag sur le mur.

>>> marcher sud
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Une porte fermée à clef porte un symbole ``livre'' ainsi qu'un panneau 
``accès réservé au personnel''.  Une autre porte, qui elle n'est pas fermée 
indique ``réserve''.  Enfin, une porte est marquée ``gallerie nord''.

Ici se trouve un ascenseur.

>>> marcher ouest
Vous arrivez dans une pièce pleine de livres rangés sur des étagères.  Il fait
vraiment sombre, et vous ne parvenez pas à distinguer les titres des ouvrages,
sauf les quelques-un qui sont juste à côté de l'éclairage "sortie de secours" 
près de la porte.

Ici se trouve un guide OpenSSL (tome I) : chaînes de caractères.
Ici se trouve un guide OpenSSL (tome II) : chiffrement symétrique.
Ici se trouve un guide OpenSSL (tome III) : génération d'une paire de clef.
Ici se trouve un guide OpenSSL (tome IV) : chiffrement à clef publique.
Ici se trouve un guide OpenSSL (tome V) : signature.
Ici se trouve un guide OpenSSL (tome VI) : script d'exemple.

[c708724ce663b68cf935ada3b098c81f] YO !
>>> prendre chaîne de caractères
OK

>>> prendre chiffrement symétrique
OK

>>> prendre tome III
OK

>>> prendre chiffrement à clef publique
OK

>>> prendre signature
OK

[c708724ce663b68cf935ada3b098c81f] Mon dieu en fin réussit, ceux au labo, faites gaffe aux erreurs Unicode, ça vous fera gagner 10h :')
>>> prendre script d'exemple
OK

>>> ls
Vous arrivez dans une pièce pleine de livres rangés sur des étagères.  Il fait
vraiment sombre, et vous ne parvenez pas à distinguer les titres des ouvrages,
sauf les quelques-un qui sont juste à côté de l'éclairage "sortie de secours" 
près de la porte.


>>> sortir
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Une porte fermée à clef porte un symbole ``livre'' ainsi qu'un panneau 
``accès réservé au personnel''.  Une autre porte, qui elle n'est pas fermée 
indique ``réserve''.  Enfin, une porte est marquée ``gallerie nord''.

Ici se trouve un ascenseur.

>>> plan

>>> marcher nord
Vous êtes dans un couloir plongé dans l'obscurité, orienté nord-sud.  L'éclairage 
d'urgence ne fonctionne qu'à moitié, donc vous n'y voyez rien du tout.

Ici se trouve un tag sur le mur.

>>> conseil
Vous pouvez obtenir des indications avec cette commande.

Sans argument, cette commande vous suggérera une tâche à accomplir.

Avec le nom d'un objet en argument, la commande vous donnera des conseils de plus en
plus précis pour vous aider à acquérir ou à utiliser l'objet en question.

Si vous avez bien compris, vous pouvez ré-essayer.

>>> conseil
Vous devez utiliser un terminal de service.  Il y en a un pas très loin.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Un mur porte l'inscription :
                                _ _     
                               / |    | 
                                      \ 
                               |  _ _  |
                                _|___   
Trois portes conduisent au nord, au sud et à l'est.

Ici se trouve un ascenseur.
Ici se trouve une baie vitrée.

>>> marcher nord
Vous êtes dans un couloir orienté nord-sud.  C'est presque le noir complet.  

Ici se trouve une tourelle de défense inactive (Mk 1).

>>> marcher nord
Vous arrivez dans une pièce en forme d'arc de cercle (270°), avec l'éclairage 
d'urgence.  Trois portes donnent sur les couloirs vers l'est, le nord et le sud.

Ici se trouve un ascenseur.

>>> marcher nord
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher est
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> ls
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un terminal posé sur un bureau.

>>> plan

>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Sur un mur, il y a une inscription à moitié effacée :
                                    _   
                               / |__  / 
                                 |  _   
                                   _ ) |
                               |_  _ _/   
Deux portes donnent au sud et à l'est.

Ici se trouve un ascenseur.

>>> marcher est
Vous êtes dans un couloir orienté est-ouest.  Les néons ne fonctionnent
toujours pas, mais avec l'éclairage de secours vous distinguez une porte 
entrouverte dans la pénombre.  Elle donne sur un local de service.


>>> plan

>>> marcher nord
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

>>> utiliser terminal



[Lower brain functions initialized]

Vous êtes dans un local poubelle.  Il fait tout noir. Il y a des néons au
plafond, mais ils sont éteints.  Seul un éclairage d'urgence de faible
intensité, au niveau du sol, éclaire un peu la pièce.  Le sol et les murs
sont couverts de carrelage, probablement pour faciliter le nettoyage. Une
porte équipée d'une barre anti-panique donne sur une autre pièce.

Ici se trouvent des déchets.
Ici se trouve un conteneur-poubelle.
Ici se trouve une inscription sur le sol.

>>> sortir
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher ouest
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un pied-de-biche.
Ici se trouve un terminal posé sur un bureau.

>>> prendre pied de biche
OK

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un pied-de-biche.

>>> utiliser terminal
ERROR: unknown username ``Yannick ''

>>> Yz134679258
Il n'y a pas de YZ134679258

>>> utiliser terminal
ERROR: incorrect password

>>> Yz134>679258
Il n'y a pas de YZ134>679258

>>> Yannick
Il n'y a pas de YANNICK

>>> utiliser terminal

Vous entendez un bruit électrique derrière vous.

La machine bizarre qui se trouve au milieu de la pièce est maintenant sous tension !

                                                                                       Process complete --- shutdown                                                                                        

Vous entendez la machine s'éteindre.

Vous vous demandez à quoi elle sert vraiment.  En attendant, quelque chose a l'air
légèrement différent, mais ne parvenez pas à mettre le doigt dessus.
[955da831bc87628e02776b161457bff2] je te vois...
>>> an
[security engine - ERROR] corrupted configuration file
[security engine - INFO] enforcing DEFAULT security policy
>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Sur un mur, il y a une inscription à moitié effacée :
                                    _   
                               / |__  / 
                                 |  _   
                                   _ ) |
                               |_  _ _/   
Deux portes donnent au sud et à l'est.

Ici se trouve un ascenseur.

>>> marcher nord
Impossible depuis cet endroit

>>> marcher
Dans quelle direction ?

>>> marcher nord
Impossible depuis cet endroit

>>> marcher est
Vous êtes dans un couloir orienté est-ouest.  Les néons ne fonctionnent
toujours pas, mais avec l'éclairage de secours vous distinguez une porte 
entrouverte dans la pénombre.  Elle donne sur un local de service.


[security engine - ERROR] corrupted event log
>>> marcher nord
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

[security engine - INFO] starting event log recovery
>>> ls
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

>>> plan

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un pied-de-biche.
 - un plan interactif.
 - un extincteur.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire génération d'une paire de clef
Le mot CLEF est ambigü. Cela pourrait être :
 - guide OpenSSL (tome III) : génération d'une paire de clef
 - guide OpenSSL (tome IV) : chiffrement à clef publique

>>> lire tome III
GÉNÉRATION D'UNE PAIRE DE CLEFS
===============================

Openssl permet de générer des paires de clefs, avec la commande : 

    openssl genpkey <options>

Encore une fois, vous êtes encouragés à consulter "man genpkey" et 
la documentation de openssl.  Par défaut, le résultat est envoyé sur
la sortie standard.  Le résultat contient la paire de clefs, au format
PEM (c'est de l'ASCII) propre à openssl et un peu pénible à décoder à
la main. 

Par exemple, pour générer une paire de clefs RSA de 1024 bits :

    openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:1024


Une commande permet d'extraire la clef publique uniquement, pour la
communiquer à des tiers : 

    openssl pkey -in <fichier contenant la clef secrète> -pubout



>>> openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:1024
Il n'y a pas de RSA_KEYGEN_BITS:1024

>>> Connection closed by foreign host.
weikai@weikai-ZenBook-Pro-15-UX550GDX-UX580GD:~$ telnet m1.tme-crypto.fr 1337ncy_grid pub_occupancy_grid telnet m1.tme-crypto.fr 1337
Trying 132.227.66.12...
Connected to m1.tme-crypto.fr.
Escape character is '^]'.



[Lower brain functions initialized]

Vous êtes dans un local poubelle.  Il fait tout noir. Il y a des néons au
plafond, mais ils sont éteints.  Seul un éclairage d'urgence de faible
intensité, au niveau du sol, éclaire un peu la pièce.  Le sol et les murs
sont couverts de carrelage, probablement pour faciliter le nettoyage. Une
porte équipée d'une barre anti-panique donne sur une autre pièce.

Ici se trouvent des déchets.
Ici se trouve un conteneur-poubelle.
Ici se trouve une inscription sur le sol.

>>> sortir 
Vous êtes dans une sorte d'atelier, assez haut de plafond.  Toujours pas
de fenêtre.  Malgré la faible intensité de l'éclairage d'urgence, vous
distinguez une espèce de grande trappe dans le plafond.  Elle est fermée.
Le mur ouest porte une inscription à moitié illisible à cause de l'obscurité :
        _     _   _     ___  _     __ __ ____         __ _  _ _ _ _        _  
   /    /  __/ ___|   __| |   | __  |    \        _   _| _ _ |          \ 
    _    |              |     |  _  | |_)    /     |   |   |     |        
 /  __    __  |_ _    __|    _|  ___   _ <  / _    | | | |     |_| |      
 _     _\ ___  _  |__ __ _    |___ _ _| \_\ _/   \_\_    _  _| __ /|    _\

En dessous, il y a une porte blindée bardée de panneaux avec des pictogrammes
en forme d'éclair, de point d'exclamation, de tête de mort...  Et la mention : 
"portez un casque et des lunettes de protection".  Vous avisez aussi deux autres 
portes : une la mention "local poubelle" tandis que l'autre est surmontée d'une 
lampe qui indique une sortie de secours.

Ici se trouve un interrupteur sur le mur.
Ici se trouve une inscription sur la porte blindée.

>>> marcher ouest
Vous êtes dans une grande pièce complètement obscure.  Avec le peu de lumière qui 
vient de l'extérieur, vous distinguez un gros fatras de machines étranges.  
On dirait que des dispositifs expérimentaux de physique des particules ont 
été entassés ici depuis des générations.  Là-dedans, vous distinguez quand 
même quelques objets.  Il y a deux portes à l'est et à l'ouest surmontées de
lampes indiquant une sortie de secours. 

Ici se trouve un dispositif expérimental étrange au milieu de la pièce.
Ici se trouve un pied-de-biche.
Ici se trouve un terminal posé sur un bureau.

>>> utiliser terminal

Vous entendez un bruit électrique derrière vous.

La machine bizarre qui se trouve au milieu de la pièce est maintenant sous tension !

                                                                                       Process complete --- shutdown                                                                                        

Vous entendez la machine s'éteindre.

Vous vous demandez à quoi elle sert vraiment.  En attendant, quelque chose a l'air
légèrement différent, mais ne parvenez pas à mettre le doigt dessus.
[924fa29c50b2aaacce387cf6e94e7508] error
>>> 
>>> Le mot R est ambigü. Cela pourrait être :
 - dispositif expérimental étrange au milieu de la pièce
 - terminal posé sur un bureau
 - carte de l'université
 - plan interactif
 - extincteur
 - guide OpenSSL (tome I) : chaînes de caractères
 - guide OpenSSL (tome II) : chiffrement symétrique
 - guide OpenSSL (tome III) : génération d'une paire de clef
 - guide OpenSSL (tome IV) : chiffrement à clef publique
 - guide OpenSSL (tome V) : signature
 - guide OpenSSL (tome VI) : script d'exemple

[security engine - ERROR] corrupted configuration file
>>> marcher ouest
Vous êtes dans un couloir orienté nord-sud.  Une porte donne sur une pièce
côté est.

Ici se trouve une inscription sur la porte.

[security engine - INFO] enforcing DEFAULT security policy
>>> marcher nord
Vous arrivez dans un petit couloir en forme d'arc de cercle, avec l'éclairage 
d'urgence.  Sur un mur, il y a une inscription à moitié effacée :
                                    _   
                               / |__  / 
                                 |  _   
                                   _ ) |
                               |_  _ _/   
Deux portes donnent au sud et à l'est.

Ici se trouve un ascenseur.

>>> marcher nord
Impossible depuis cet endroit

>>> marcher est
Vous êtes dans un couloir orienté est-ouest.  Les néons ne fonctionnent
toujours pas, mais avec l'éclairage de secours vous distinguez une porte 
entrouverte dans la pénombre.  Elle donne sur un local de service.


>>>  marcher nord
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

>>> utiliser terminal
[security engine - ERROR] corrupted event log
[security engine - INFO] starting event log recovery
>>> 
>>> ls
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

>>> utiliser terminal

>>> 0
Impossible depuis cet endroit

>>> utiliser terminal

>>> utiliser terminal

>>> utiliser terminal

>>> utiliser terminal
[16cffd19ccecacb0221fb22dcaa803bc] test
>>> 
>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un extincteur.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire script d'exemple
import subprocess

# ce script suppose qu'il a affaire à OpenSSL v1.1.1
# vérifier avec "openssl version" en cas de doute.
# attention à MacOS, qui fournit à la place LibreSSL.

# en cas de problème, cette exception est déclenchée
class OpensslError(Exception):
    pass

# Il vaut mieux être conscient de la différence entre str() et bytes()

def encrypt(plaintext, passphrase, cipher='aes-128-cbc'):
    """invoke the OpenSSL library (though the openssl executable which must be
       present on your system) to encrypt content using a symmetric cipher.

       The passphrase is an str object (a unicode string)
       The plaintext is str() or bytes()
       The output is bytes()

       # encryption use
       >>> message = "texte avec caractères accentués"
       >>> c = encrypt(message, 'foobar')       
    """
    # prépare les arguments à envoyer à openssl
    pass_arg = 'pass:{}'.format(passphrase)
    args = ['openssl', 'enc', '-' + cipher, '-base64', '-pass', pass_arg, '-pbkdf2']
    
    # si plaintext est de stype str, on est obligé de l'encoder en bytes pour
    # pouvoir l'envoyer dans le pipeline vers openssl
    if isinstance(plaintext, str):
        plaintext = plaintext.encode('utf-8')
    
    # ouvre le pipeline vers openssl. envoie plaintext sur le stdin de openssl, récupère stdout et stderr
    #    affiche la commande invoquée
    #    print('debug : {0}'.format(' '.join(args)))
    result = subprocess.run(args, input=plaintext, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

    # si un message d'erreur est présent sur stderr, on arrête tout
    # attention, sur stderr on récupère des bytes(), donc on convertit
    error_message = result.stderr.decode()
    if error_message != '':
        raise OpensslError(error_message)

    # OK, openssl a envoyé le chiffré sur stdout, en base64.
    # On récupère des bytes, donc on en fait une chaine unicode
    return result.stdout.decode()

# TODO :
# - implement the decrypt() method
# - write a KeyPair class
# - write a PublicKey class
# - etc.

>>> ls
Vous arrivez dans une petite pièce sombre.  Dans l'obscurité, vous distinguez 
un bureau, une chaise, quelques affaires personnelles.  Peut-être le bureau
d'un chef ?

Ici se trouve un terminal de service.

>>> utiliser terminal

>>> inventaire
Vous avez :
 - une carte de l'université.
 - un plan interactif.
 - un extincteur.
 - un guide OpenSSL (tome I) : chaînes de caractères.
 - un guide OpenSSL (tome II) : chiffrement symétrique.
 - un guide OpenSSL (tome III) : génération d'une paire de clef.
 - un guide OpenSSL (tome IV) : chiffrement à clef publique.
 - un guide OpenSSL (tome V) : signature.
 - un guide OpenSSL (tome VI) : script d'exemple.

>>> lire chiffrement à clef publique
CHIFFREMENT À CLEF PUBLIQUE
===========================

Openssl permet d'effectuer du chiffrement/déchiffrement asymétrique, avec
l'algorithme RSA.  Vous êtes invité à consulter la page de manuel
correspondante (man openssl-pkeyutl). 

L'usage d'openssl pour effectuer des opérations de (dé)chiffrement asymétrique
a deux limitations :

1) Le message clair DOIT être plus court que la clef.  Si ce n'est pas le cas,
   l'opération échoue avec un message "Public Key operation error, data too 
   large for key size".  Avec une clef de 2000 bits, vous avez droit à environ
   1800 bits de message.  C'est une limitation de l'algorithme lui-même.

2) Openssl ne prévoit pas d'encoder le résultat de l'opération de chiffrement
   en base64.  Par contre il y a une option pour l'encodage en... hexadécimal.

La commande essentielle pour le chiffrement :

   openssl pkeyutl -encrypt -hexdump -pubin -inkey <fichier contenant la clef publique>

Ceci attend un message sur l'entrée standard, et affichera son chiffrement sur
la sortie standard.  Pour déchiffrer, il faut fournir la clef secrète (et donc
retirer l'option  "-pubin")

>>> utiliser
Merci de vous exprimer clairement et de fournir un complément d'objet direct (valide).

>>> utiliser terminal
[security engine] pki.tutorial:136:1|78d578987ec1b855d24acd949d3e539c0e014982e4050cfb0add6e9dea3e40ce
>>> 
[security engine - INFO] event log recovery complete
[security engine - INFO] recovered security log entry:
                             event: security engine process KILLED by unauthorized user
                             subject: Yannick
                             timestamp: 2024-01-31 14:05:56
[security engine - INFO] updating knowledge base
                             subject: Yannick
                             nature: threat
                             level: high
[security engine - INFO] new security objective
                             subject: Yannick
                             objective: locate
[security engine - ERROR] sensor network offline (power down)
[security engine - WARNING] target locator timeout (subject: Yannick)


register:136:1|99b75790fbdbdd3d6aac5199f666744ad95939df184fe9d9bae148672833729d
pki.tutorial:136:1|78d578987ec1b855d24acd949d3e539c0e014982e4050cfb0add6e9dea3e40ce
pki.upload:136:1|63ce4e0e806c62dbd452054e03666ddb18cfa88833ef4950701dab7cb0fb0fb8
