p = 2**64 - 59


X= [11076418088753421629, 8706998050947709013, 7191771479148356315, 4623309505343411690, 14624341790120905677, 2452883785903005957, 10745357394821883076, 8815050349987205597, 9691597964733662161, 1051987981374142677, 14312235052111830264, 10277271864882619825, 6536207320333831849, 3876567034357808371, 14670376801622874254, 9644350614060509929, 11511550128633948269, 2120855424805430694, 14460267831583409001, 10668586238612214805]
A= [7686608385720349770, 15153149934418416540, 15299296716753628635, 7241093506567156702, 507832380422200912, 4499875947754265291, 7737680202586184180, 7062958796710331423, 13935543229368151833, 13341931234160004213, 12156969734956114221, 1419197210992617516, 6386221461057217788, 6711557934583630145, 5855271615998035658, 763689926175753674, 9511821231828443876, 4980728924730634604, 737348931979746147, 11186377072910723518]
B= [15661612809505991129, 1009168618027814139, 1787832880029714768, 10643451147769055583, 6921682530455852672, 9032970754592820922, 3324862657699626989, 9018064321828283884, 5942049156107282108, 18441817635848035559, 12597977808998524150, 17652158009887526940, 18212973720559828319, 5767209027676894074, 10250217025885007159, 12743919388974130786, 5995040145252375607, 9230537829737548789, 2175952790856844478, 1889937226125290142]

p = 2**64 - 59
R = PolynomialRing(Zmod(p), 'x')

# Disons que vous avez ces points collectés et validés pour R, S, T
points_R = [(X[i], A[i]) for i in range(9)]  # Assurez-vous d'avoir au moins 9 points uniques pour R
points_S = [(X[i], B[i]) for i in range(17)]  # Assurez-vous d'avoir au moins 17 points uniques pour S
#points_T = [(X[i], C[i]) for i in range(25)]  # Assurez-vous d'avoir au moins 25 points uniques pour T

# Calcul des polynômes de Lagrange
poly_R = R.lagrange_polynomial(points_R)
poly_S = R.lagrange_polynomial(points_S)
#poly_T = R.lagrange_polynomial(points_T)

# Extraction des clés
key_R = hex(poly_R(0))
key_S = hex(poly_S(0))
#key_T = hex(poly_T(0))

print(f"Clé R(0): {key_R}")
print(f"Clé S(0): {key_S}")
#print(f"Clé T(0): {key_T}")
